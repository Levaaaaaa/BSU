SELECT AVG(CONVERT(DECIMAL(10,5), OCENKA)) FROM USP FIRST GROUP BY UDATE HAVING AVG(CONVERT(DECIMAL(10,5), OCENKA)) = (SELECT MIN(OCENKA) FROM USP SECOND WHERE FIRST.UDATE = SECOND.UDATE);